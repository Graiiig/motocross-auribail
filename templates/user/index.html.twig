{% extends 'base.html.twig' %}

{% block title %}Mon compte MC Auribail
{% endblock %}

{% block body %}

	<div class="container mt-5">
	<div class="row">
	{% if sessions|length == 0 %}
					<p class="text-center offset-6 col-4">Vous n'avez participé à aucun entraînement, vous pouvez vous inscrire à la prochaine session <span class="material-icons-outlined align-middle">
arrow_downward
</span> </p>
	{% endif %}
	</div>
		<div class="row justify-content-center">
			<div class="card text-center mx-5">
				<div class="card-header">
					Mes informations personnelles :

				</div>
				<div class="card-body">
					<h5 class="card-title">{{app.user.lastName ~ " " ~ app.user.firstName}}</h5>
					<p class="card-text">{{ app.user.email }}</p>
					<p class="card-text">{{ app.user.birthDate | date ('d/m/Y') }}</p>
					<p class="card-text"><a href="{{path('app_forgot_password_request')}}"> Modifier mon mot de passe</a></p>

				</div>
				<div class="card-footer text-muted">
					{% if is_granted('ROLE_MEMBER') %}
						Adhérent du club
					{% elseif is_granted('ROLE_NON_MEMBER')%}
						Non adhérent du club
					{% endif %}
				</div>
			</div>
			{# TODO : Ajouter "mot de passe oublié" #}
			<div class="col-5">

				{% if sessions|length == 0 %}
					
					<div class="card text-center mx-5">
						<div
							class="card-header">
							Inscription pour l'entrainement du
							<span data-date="{{nextSession.session.date | date('Y-m-d')}}" class="date-1 date">{{nextSession.session.date | date('d/m/Y')}}</span>
							:
						</div>
						<div class="card-body">
							<h5 class="card-title">{{nextSession.session.title}}</h5>
							<p class="card-text">Place(s) adultes restantes :
								{{nextSession.adults}}</p>
							<p class="card-text">Place(s) enfants restantes :
								{{nextSession.children}}</p>

							{% if nextSession.usersInSession < 75 %}
								{% if app.user %}
									<a href="{{path('session', {'id':nextSession.session.id})}}" class="btn btn-primary">S'inscrire</a>
								{% else %}
									<a href="{{path('app_login')}}" class="btn btn-primary">S'inscrire</a>
								{% endif %}
							{% else %}
								<a class="btn btn-primary">Plus de place de disponibles, voir les prochaines courses</a>
							{% endif %}

						</div>
						<div class="card-footer text-muted">
							<span>Dans
							</span>
							<span class="date-1-diff"></span>
							<span>
								jours</span>
						</div>
					</div>

				{% endif %}
				{% for session in sessions %}


					{% set difference = date("now").diff(date(session.date)) %}

					{% if difference.invert == 1 %}
						<ul class="list-group">
							<li class="list-group-item active">Les courses auxquelles j'ai participé :
							</li>
							<li class="list-group-item">
								{{session.title | lower}}
								le
								{{session.date | date ('d/m/Y')}}</li>
						</ul>
					{% else %}
						<ul class="list-group mt-5">
							<li class="list-group-item active">Mes prochaines courses :
							</li>
							<li class="list-group-item">
								{{session.title | lower}}
								le
								{{session.date | date ('d/m/Y')}} <a class="float-right" href="{{ path('user_leave_session', {'session' : session.id} )}}"><span class="material-icons-outlined align-middle">
								delete
								</span></a></li>
						</ul>
					{% endif %}

				{% endfor %}

			</div>
		</div>
	</div>

{% endblock %}
{% block javascripts %}
    <script type="text/javascript" src="scripts.js"></script>
{% endblock %}
